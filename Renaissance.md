# 产品设计文档：文艺复兴 (Renaissance)

## 1. 项目愿景

打造一个承载情感的音乐容器，让老歌的旋律在现代技术中通过**"延迟满足"**和**"氛围重塑"**重新焕发生命力。

---

## 2. 核心设计哲学

### 🌡️ 温度（Warmth）
拒绝冰冷的数字化列表，模拟物理世界的阻尼感和材质感。

### 🕯️ 仪式（Ritual）
听歌不仅仅是点击，而是通过"等待"和"探索"获得共鸣。

### ✨ 纯粹（Purity）
弱化社交压力，强化人与旋律、人与文字的跨时空连接。

---

## 3. 功能详细规格

### 3.1 低保真 (Lo-Fi) 氛围引擎

#### 设计目的
模拟深夜、雨天或老旧留声机的私人空间感。

#### 技术实现
使用 Flutter 的 `just_audio` 插件开启多音轨并行模式。

#### 交互逻辑

**混音台面板**：提供三个复古滑块

| 滑块 | 功能描述 |
|------|----------|
| 🎵 旋律（Main） | 核心音频流 |
| 🍳 炒豆声（Crackle） | 模拟黑胶唱片的摩擦噪音 |
| 🌌 时空（Space） | 动态环境音（如：1990年的街头、雨后的窗边、午后咖啡馆） |

**视觉反馈**：
- 背景采用 **Mica (云母)** 材质
- 随着混音比例的改变，界面的颗粒感（Noise Shader）随之增强或减弱

---

### 3.2 "盲盒旋律"播放模式

#### 设计目的
去标签化，让用户回归旋律本身，创造"重逢"的惊喜。

#### 视觉表现

**迷雾封层**
- 使用 `BackdropFilter` 对专辑封面进行高斯模糊处理（σ = 30）

**动态粒子**
- 模糊层上方漂浮着与旋律节奏同步的微小粒子

#### 解锁逻辑

```
阶段一 (0%-50%):   全模糊状态，仅显示歌曲年份和模糊的主色调
阶段二 (50%-90%):  随着进度条推进，模糊度线性降低，封面隐约可见
阶段三 (> 95%):    触发 Connected Animation，封面瞬间清晰，弹出"重逢成功"的微动效
```

---

### 3.3 "黄金信件" (The Golden Letter)

#### 设计目的
将乐评转化为具有收藏价值的"情感资产"。

#### 解锁机制（PoL - Proof of Listening）
> ⚠️ **重要**：只有当歌曲播放完毕，系统才会检测后端数据库，若存在他人的"黄金信件"，则在黑胶盘中心浮现一封盖有火漆印的信封。

#### 交互体验

| 特性 | 实现方式 |
|------|----------|
| 3D 翻转 | 使用 Flutter 的 `Transform` 组件实现信件开启的 3D 效果 |
| 纸张材质 | UI 采用非对称的纸张纹理，文字排版模仿手写信件 |
| 社交连接 | 用户无法搜索信件，只能通过"完整听完一首歌"来偶遇他人的感悟 |

> 💡 **设计理念**：这种随机性赋予了信件极高的情感价值。

---

## 4. 视觉风格指南

### Fluent UI × Retro

- **材质**：云母 (Mica) + 亚克力 (Acrylic)
- **配色**：暖色调为主，强调复古质感
- **动效**：物理阻尼感，拒绝线性动画
- **字体**：衬线字体用于标题，无衬线用于正文

---

## 5. 技术栈架构

| 层级 | 技术选型 | 说明 |
|------|----------|------|
| 前端框架 | Flutter | 针对桌面端优化 |
| 音频处理 | just_audio | 支持多音轨同步、淡入淡出 |
| 状态管理 | Riverpod | 处理复杂的音频状态和解锁逻辑 |
| 本地数据库 | ObjectBox | 存储缓存的信件和播放历史 |
| 后端 | Supabase | 实时同步信件，支持地理位置/年份索引 |
| 特效 | flutter_shaders | 用于实现封面颗粒感和流动模糊 |

---

## 6. 用户旅程 (User Journey)

```
┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐
│  启程   │ → │  沉浸   │ → │  调频   │ → │  共鸣   │ → │  拆信   │ → │  留念   │
└─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘    └─────────┘
     │              │              │              │              │              │
     ▼              ▼              ▼              ▼              ▼              ▼
 转动复古旋钮    盲盒模式启动    拉升"炒豆声"    歌曲终了      盘面浮现       写下感悟
 选定"1995年"   熟悉的钢琴声    窗外下起雨     《听说爱情    "黄金信件"     封装进黑胶
                封面是模糊的    Lo-fi氛围      回来过》      陌生人的       等待有缘人
                暖色            拉满           封面清晰      初恋故事       听完
```

### 场景描述

1. **启程**：用户转动复古旋钮，选定"1995年"
2. **沉浸**：盲盒模式启动，一段熟悉的钢琴声响起，封面是一团模糊的暖色
3. **调频**：用户拉升"炒豆声"滑块，窗外下起雨，Lo-fi 氛围拉满
4. **共鸣**：歌曲终了，封面清晰——是那首《听说爱情回来过》
5. **拆信**：盘面浮现一封"黄金信件"，是一个陌生人在三年前留下的初恋故事
6. **留念**：用户被打动，也写下了一行字，封装进黑胶，等待下一个有缘人听完

---

## 7. 项目结构

```
renaissance/
├── lib/
│   ├── main.dart
│   ├── app.dart
│   ├── core/
│   │   ├── theme/
│   │   ├── constants/
│   │   └── utils/
│   ├── features/
│   │   ├── player/
│   │   │   ├── audio/
│   │   │   ├── ui/
│   │   │   └── models/
│   │   ├── lofi_engine/
│   │   │   ├── mixer/
│   │   │   └── effects/
│   │   ├── blindbox/
│   │   │   ├── blur/
│   │   │   └── unlock/
│   │   └── golden_letter/
│   │       ├── models/
│   │       ├── repository/
│   │       └── ui/
│   └── shared/
│       ├── widgets/
│       └── components/
├── assets/
│   ├── audio/
│   ├── images/
│   └── shaders/
└── test/
```

---

*"音乐是时间的艺术，而我们要做的是让时间有温度。"*
